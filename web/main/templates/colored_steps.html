{% extends "base_page.html" %}
{%  block more_head %}
<title>{{step_lighter.all_steps | length}} {{pipeline_mode | upper}} Steps - {{base_title}}</title>
<link href="{{url_for('static', filename='css/colored_steps.css') | staticversion }} " rel="stylesheet">
{%  endblock %}
{% block content %}

<a class="btn btn-warning" href="{{url_for('main.paper_show', paper_id=paper_id)}}"> Back to paper</a>
<a class="btn btn-warning" href="{{url_for('main.enlighted_json', pipeline_mode=pipeline_mode, paper_id=paper_id, step_num=curr_step, comp_type='raw')}}"> Raw Json {{curr_step}}</a>
{% if pipeline_mode == 'sutime' %}
<a class="btn btn-warning" href="{{url_for('main.enlighted_json', pipeline_mode=pipeline_mode, paper_id=paper_id, step_num=curr_step, comp_type='analysed')}}"> Analysed {{curr_step}}</a>
{% endif %}
<br>
<br>
{% if curr_step == 0 %}
    {% set prev_step = 0 %}
{% else %}
    {% set prev_step = curr_step -1 %}
{% endif %}
{% if curr_step == (step_lighter.all_steps  | length) -1 %}
    {% set next_step = (step_lighter.all_steps  | length) -1 %}
{% else %}
    {% set next_step = curr_step + 1 %}
{% endif %}
<div id="step_navigator">
    <a href="{{url_for('main.paper_pipeline', pipeline_mode=pipeline_mode, paper_id=paper_id, step_num=prev_step)}}">Prev {{pipeline_mode}}</a>
    <a href="{{url_for('main.paper_pipeline', pipeline_mode=pipeline_mode, paper_id=paper_id, step_num=next_step)}}">{{pipeline_mode}} Next</a>
</div>
<div id="step_menu">
    {% for step in range(step_lighter.all_steps|length) %}
    {% if step - curr_step == 0 %}
    <a class="a_selected" title="{{step_lighter.all_steps[step]}}" href="{{url_for('main.paper_pipeline', pipeline_mode=pipeline_mode, paper_id=paper_id, step_num=step)}}">{{pipeline_mode}} {{step}}</a>
    {% else %}
    <a title="{{step_lighter.all_steps[step]}}" href="{{url_for('main.paper_pipeline', pipeline_mode=pipeline_mode, paper_id=paper_id, step_num=step)}}">{{pipeline_mode}} {{step}}</a>
    {% endif %}
    {% endfor %}
</div>
<h3>{{step_lighter.caption}}</h3>

    <div id="highlight_legend">
        <span class="highlight DATE">DATE</span>
        <span class="highlight DURATION">DURATION</span>
        <span class="highlight TIME">TIME</span>
        <span class="highlight sat">SAT</span>
        <span class="highlight instr">INSTR</span>
        <span class="highlight region">REGION</span>
    </div>
<div id="colored_content">
    {% if disp_mode == "enlighted" %}
    {{step_lighter.enlighted_txt|safe}}
    {% elif disp_mode == "raw" %}
    <pre>
    {{step_lighter.raw_json|safe}}
    </pre>
    {% elif disp_mode == "analysed" %}
    <pre>
    {{step_lighter.analysed_json|safe}}
    </pre>
    {% endif %}
</div>

{% endblock %}
